{% load i18n %}
{% include "wagtailadmin/shared/header.html" with title=page_title icon=icon tabbed=tabbed merged=tabbed %}

{% if tabbed %}

    <ul class="tab-nav merged">
        <li class="{% if not create_form.errors %}active {% endif %}"><a href="#{{ prefix }}-search">{{ search_tab_label }}</a></li>
        <li class="{% if create_form.errors %}active {% endif %}"><a href="#{{ prefix }}-create">{{ create_tab_label }}</a></li>
    </ul>

    <div class="tab-content">
        <section id="{{ prefix }}-search" class="{% if not create_form.errors %}active {% endif %}nice-padding">
            {% if is_searchable %}
                {% include "generic_chooser/_search_form.html" %}
            {% endif %}

            <div id="search-results" class="listing">
                {% include results_template %}
            </div>
        </section>

        <section id="{{ prefix }}-create" class="{% if create_form.errors %}active {% endif %}nice-padding">
            <form class="create-form" action="{{ choose_url }}" method="POST" {% if create_form.is_multipart %}enctype="multipart/form-data"{% endif %} novalidate>
                {% csrf_token %}
                {% block hidden_fields %}
                    {% for field in create_form.hidden_fields %}{{ field }}{% endfor %}
                {% endblock %}

                <ul class="fields">
                    {% block visible_fields %}
                        {% for field in create_form.visible_fields %}
                            {% include "wagtailadmin/shared/field_as_li.html" %}
                        {% endfor %}
                    {% endblock %}
                    <li>
                        {% if create_form_is_long_running %}
                            <button type="submit" class="button button-longrunning" data-clicked-text="{{ create_form_submitted_label }}"><span class="icon icon-spinner"></span><em>{{ create_form_submit_label }}</em></button>
                        {% else %}
                            <button type="submit" class="button">{{ create_form_submit_label }}</button>
                        {% endif %}
                    </li>
                </ul>
            </form>
        </section>
    </div>

{% else %}

    <div class="nice-padding">
        {% if is_searchable %}
            {% include "generic_chooser/_search_form.html" %}
        {% endif %}

        <div id="search-results" class="listing">
            {% include results_template %}
        </div>
    </div>

{% endif %}
